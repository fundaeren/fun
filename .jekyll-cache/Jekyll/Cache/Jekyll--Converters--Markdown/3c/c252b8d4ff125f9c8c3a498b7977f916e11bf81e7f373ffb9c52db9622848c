I"L<h1 id="log-analysis">Log Analysis</h1>

<p>ვაგრძელებთ კიბერ ოლიმპიადის(cybercube) ამოცანების განხილვას, თუ წინა 2 სტატია არ გინახავს, შეგიძლია მათ გაეცნო:</p>

<p>ვაგრძელებთ კიბერ ოლიმპიადის(<strong>cybercube</strong>) ამოცანების განხილვას, თუ წინა 2 სტატია არ გინახავს, შეგიძლია მათ გაეცნო:</p>

<blockquote>
  <p><strong>Pcap Analysis</strong> — <a href="https://bit.ly/2M9L7f0">https://bit.ly/2M9L7f0</a></p>
</blockquote>

<blockquote>
  <p><strong>რა არის Buffer Overflow ?</strong>- <a href="https://bit.ly/2GZbNLr">https://bit.ly/2GZbNLr</a></p>
</blockquote>

<p>დღეს განვიხილავ ერთ-ერთი კატეგორიის, ლოგ ფაილების ანალიზის, რამდენიმე ამოცანას და ვეცდები, თითოეული ნაბიჯი დეტალურად ავხსნა.</p>

<p>კიბერ ოლიმპიადაზე გამოყენებული სავარჯიშოები შეგიძლიათ <a href="https://cyber-lab.tech/geo/challenges"><strong>cyber-lab</strong></a> — ზე იხილოთ.</p>

<p>მოდი ჩვენი პირველი ამოცანა იყოს <strong>userpro</strong>, რომლის პირობაც შემდეგია:</p>

<p><img src="img/1__lMduzKu2__HxWSTBslAaK1w.png" alt="" /></p>

<p>მოცემული გვაქვს <strong>Apache</strong>-ის <strong>Log</strong> ფაილი, მოდი მისი ანალიზისთვის არ გამოვიყენოთ უკვე არსებულები ხელსაწყოები და ჩვენით დავწეროთ პატარა სკრიპტი.</p>

<p>მაშ ასე, მოვიმარჯვოთ ჩვენი საყვარელი ედიტორები და გავხსნათ <strong>Log</strong> ფაილი.</p>

<p>ჩვენი <strong>Log</strong> ფაილი შემდეგნაირად გამოიყურება:</p>

<p><img src="img/1__HH7kgNu8b9RNFf0gEyNGdA.png" alt="**Vim is love.**" />
<strong>Vim is love.</strong></p>

<p>ალბათ პირველივე შეხედვაზე მიხვდებოდი, რომ ჩვენი <strong>Log</strong> ფაილი <strong>Wordpress</strong> ის საიტისაა.</p>

<p>მოდი სანამ <strong>Log</strong> ფაილში ძრომიალს გავაგრძელებთ, გავეცნოთ კითხვებს, რომლებზეც პასუხის გაცემა მოგვიწევს:</p>

<blockquote>
  <p><strong>1. რომელი IP მისამართებიდან განხორციელდა შეტევა?</strong></p>
</blockquote>

<blockquote>
  <p><strong>2. რა ხელსაწყო გამოიყენა შემტევმა ვებ გვერდის სკანირებისთვის?</strong></p>
</blockquote>

<blockquote>
  <p><strong>3. რომელი პლაგინის საშუალებით მოახერხა შემტევმა წვდომის მოპოვება?</strong></p>
</blockquote>

<blockquote>
  <p><strong>4. რა ტიპის შეტევა გამოიყენა შემტევმა წვდომის მოსაპოვებლად?</strong></p>
</blockquote>

<blockquote>
  <p><strong>5. რომელ ოპერაციულ სისტემას იყენებდა შემტევი?</strong></p>
</blockquote>

<p>პირველ კითხვის პასუხის გაგება მოდი დავიწყოთ <strong>IP</strong> ების სტატისტიკის გაგებით, ვნახოთ თუ რამდენი რექვესთი გაგზავნა თითოეულმა <strong>IP</strong>-მა.</p>

<p>ამისთვის პირველ რიგში უნდა წავიკითხოთ ფაილი, მაგრამ სანამ ფაილის წაკითხვაზე გადავალთ ვნახოთ, როგორ გამოიუყურება ჩვენი რექვესთი.</p>

<p><img src="img/1__qZ__Wv7L4SDDEFWvpTdv1lQ.png" alt="" /></p>

<blockquote>
  <p><strong>185.220.101.32</strong> <em>–&gt;</em> <strong><em>IP</em></strong> <em>მისამართი.</em></p>
</blockquote>

<blockquote>
  <p>**<em>[_12/Apr/2018:08:10:42 +0000]** _–&gt; თარიღი, დრო სასაათოო სარტყელი.</em></p>
</blockquote>

<blockquote>
  <p><strong>“GET / HTTP/1.1”</strong> <em>--&gt;</em> <strong><em>HTTP</em></strong> <em>რექვესთის ტიპი.</em></p>
</blockquote>

<blockquote>
  <p><strong><em>200</em></strong> <em>–&gt; სერვერის დაბრუნებული რესფონს კოდი.</em></p>
</blockquote>

<blockquote>
  <p><strong>19246</strong> <em>–&gt; გადაცემული ბაიტების რაოდენობა.</em></p>
</blockquote>

<blockquote>
  <p><strong>Mozilla/5.0 (Windows NT 6.1; rv:52.0) Gecko/20100101 Firefox/52.0</strong> <em>–&gt; აქ გვაქვს იმ მომხარებლის ინფორმაცია, რომელმაც რექვესთი გააგზავნა</em></p>
</blockquote>

<p>მაგრამ ჯერ-ჯერობით მხოლოდ <strong>IP</strong> გვაინტერესებს, როგორც უკვე აღვნიშნეთ ჩვენი პირველი ნაბიჯი</p>

<ul>
  <li><strong>Log ფაილის წაკითხვაა.</strong></li>
</ul>

<p><img src="img/1__KjUomgLqFxi0jQ3NKNHL__A.png" alt="" /></p>

<p>მოდი ახლა მეორე ნაწილზე გადავიდეთ,</p>

<ul>
  <li><strong>IP მისამართების სტატისტიკა</strong></li>
</ul>

<p><img src="img/1__q6pdBX7__H7z02RcAvSu9Iw.png" alt="[**https://gist.github.com/ls4cfk/addf7cfeba6eb7dc582ff7692c19a380#file-py**](https://gist.github.com/ls4cfk/addf7cfeba6eb7dc582ff7692c19a380#file-py)" />
<a href="https://gist.github.com/ls4cfk/addf7cfeba6eb7dc582ff7692c19a380#file-py"><strong>https://gist.github.com/ls4cfk/addf7cfeba6eb7dc582ff7692c19a380#file-py</strong></a></p>

<ul>
  <li>მთლიანი რექვესთი არ გვჭირდბება, ამიტომაც რაღაცის საშუალებით უნდა გაგვეგო მხოლოდ <strong>IP</strong> მისამართები, რაშიც ძალიან დაგვეხმარა <strong>Regex</strong>-ი.</li>
  <li>დავაიმპორტეთ რეჯექსის მოდული და დავწერეთ პატერნი, რომელიც მხოლოდ <strong>IPv4</strong> მისამართებს ეძებს.</li>
</ul>

<p><strong>r’\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}’</strong></p>

<p><strong>\d</strong> ნამდვილი რიცხვისთვის <strong>[0–9]</strong>.</p>

<p><strong>{1, 3}</strong> — წერტილიდან წერტილამდე 1 იდან 3 ის ჩათვლით სიგრძის რიცხვის მოსაძებნად.<br />
<strong>iplist = re.findall(ipv4, log)</strong></p>

<p>თუ დაემთხვა მნიშვნელობა ჩვენ პატერნს, ვინახავთ <strong>iplist</strong> ცვლადში, და <strong>Counter()</strong> ისა და <strong>most_common()</strong> ფუნქციების საშუალებით, ვითვლით და გამოგვაქვს სასურველ ფორმატში.</p>

<p><strong>ipcount = Counter(iplist)<br />
for k, v in ipcount.most_common():<br />
   print(f”IP =&gt; {str(k)} რაოდენობა =&gt; {str(v)}”)</strong></p>

<p>შედეგიც მივიღეთ:</p>

<p><img src="img/1__IhWS0CaGiyRhl29ZdPgaIA.png" alt="" /></p>

<p>კარგი გვაქვს <strong>IP</strong> ები, ყველა ხშირად გამოყენებულიც ვიცით რომელია, მაგრამ როგორ გავიგოთ მართლა შემტევისაა თუ არა ეს <strong>IP</strong>?</p>

<p>მოდი ვნახოთ პირველი <strong>IP</strong>, ვნახოთ თუ სად ფიგურირებს ის.</p>

<blockquote>
  <table>
    <tbody>
      <tr>
        <td>**cat case1.log</td>
        <td>grep 164.132.106.162**</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<blockquote>
  <p>თუ ვინდოუსზე ხართ, სასურველი ტექსტ ედიტორი გახსენით და <strong>Ctrl +f</strong> :)</p>
</blockquote>

<p><img src="img/1__Ry4atfWIbfP4fnkzbDppJQ.png" alt="" /></p>

<p>რექვესთი ჩვენს მიერ განხილულს გავს, მაგრამ ბოლოში ახალი საინტერესო რამ გამოჩნდა. <strong>WPScan</strong>-ი, ის სკანერია რომლის დანიშნულებაც <strong>WordPress</strong> ის საიტებში მოწყვლადობის პოვნაა.</p>

<p>ამ რექვესთის საშუალებით, მეორე კითხვის პასუხიც გავიგეთ — შემტევს ხელსაწყო <strong>WPScan</strong>-ი გამოუყენებია.</p>

<p>მოდი <strong>IP</strong> ების დასადგენად, ჩვენი რექვესთები გავფილტროთ ‘<strong>WPScan</strong>’ ით, გამოვიტანოთ მხოლოდ ის <strong>IP</strong> ები, რომლებშიც აღნიშნული სკანერი ფიგურირებს.</p>

<p>ცოტა გადავაკეთოთ ჩვენი კოდი:</p>

<p><img src="img/1__6G8pps1Cos1PlJWdY__TlcA.png" alt="[**https://gist.github.com/ls4cfk/addf7cfeba6eb7dc582ff7692c19a380#file-filtering-by-wpscan**](https://gist.github.com/ls4cfk/addf7cfeba6eb7dc582ff7692c19a380#file-filtering-by-wpscan)" />
<a href="https://gist.github.com/ls4cfk/addf7cfeba6eb7dc582ff7692c19a380#file-filtering-by-wpscan"><strong>https://gist.github.com/ls4cfk/addf7cfeba6eb7dc582ff7692c19a380#file-filtering-by-wpscan</strong></a></p>

<p><strong>IP</strong> ებიც გავიგეთ, 164.132.106.162 და 122.116.50.42</p>

<p><img src="img/1__txEMxF6qqCXasMKWcLZBEQ.png" alt="" /></p>

<p>მოდი სანამ შემდეგ კითხვაზე გადავალთ, გავასუფთავოთ ჩვენი ლოგ ფაილი, დავტოვოთ მხოლოდ ის რექვესთები სადაც ჩვენი <strong>IP-</strong>ები ფიგურირებს.</p>

<p>მთლად დიდი შედეგი ვერ მივიღეთ, მაგრამ 300 ხაზით შევამოკლეთ ჩვენი ლოგ ფაილი.</p>

<p><img src="img/1__4NR9JpeHETVNlTVflknoWA.png" alt="" /></p>

<p>აშკარად ბევრი ისეთი რექვესთი გვაქვს, რომლებსაც 404 კოდი დაუბრუნდათ. ეგენიც არ გვჭირდება, მოდი კიდევ ერთხელ გავფილტროთ.</p>

<p><img src="img/1__CXWAt3txd__r6XagcUk__36A.png" alt="" /></p>

<p>Sweet!, 36 რექვესთზე დავედით. მოდი ჩავიხედოთ დარჩენილ რექვესთებში:</p>

<p><img src="img/1__pDzNMeFJLbho6fetHaFfDg.png" alt="" /></p>

<p>ამ რექვესთებიდან ვარკვევთ, რომ <strong>WPScan</strong> ის სკანირების დასრულების შემდეგ,დაახლოებით 1 წუთში, გაიგზავნა რექვესთი <strong>?up_auto_log=true</strong>, რომელმაც შემტევს მისცა საიტზე წვდომა.</p>

<p><a href="http://www.exploit-db.com"><strong>exploit-db</strong></a> — ზე თუ გადავამოწმებთ აღმოვაჩენთ, რომ აღნიშნული რექვესთის საშუალებით ავტორიზაციის ავლის საშუალებას, პლაგინი <strong>userpro</strong> გვაძლევდა.</p>

<p><img src="img/1__vQ5xvMdasXzLEYK8yb__d6A.png" alt="" /></p>

<p>გავარკვიეთ მესამე და მეოთხე კითხვის პასუხიც:</p>

<p><strong>userpro</strong> და <strong>Authentication Bypass</strong></p>

<p>დაგვრჩა ბოლო კითხვა, რომლის პასუხიც ჩვენს მიერ გაფილტრურ ლოგებში კარგად ჩანს:</p>

<p><img src="img/1__FypOOReztGFDesHkhhHWpA.png" alt="" /></p>

<p>შემტევი იყენებდა Linux-ის ერთ-ერთ დისტრიბუტივს — Ubuntu-ს.</p>

<h3 id="მოდი-შემდეგი-ამოცანა-fisheyeიყოს">მოდი შემდეგი ამოცანა Fisheye იყოს</h3>

<p>რომლის პირობაც შემდეგია:</p>

<p><img src="img/1__4H49krojWTaK9__ua4g83Wg.png" alt="" /></p>

<p><strong>Fisheye</strong> — ს შემთხვევაში მოცემული გვაქვს წერილი და შემდეგი <strong>3</strong> შეკითხვა:</p>

<blockquote>
  <p><strong>1. შეტევის რომელი ტიპი გამოიყენა შემტევმა?</strong></p>
</blockquote>

<blockquote>
  <p><strong>2. რა სახის ინფორმაციის მოპარვას ცდილობს შემტევი?</strong></p>
</blockquote>

<blockquote>
  <p><strong>3. დაასახელეთ შეტევაში გამოყენებული მისამართი</strong></p>
</blockquote>

<p>კვლავ მოვიმარჯვოთ საყვარელი ედიტორები და გავხსნათ ჩვენი მეილი.</p>

<p><img src="img/1__69F2oLA__Raj4LpNQ__jwJoQ.png" alt="" /></p>

<p>ნუ, სტანდარტული მეილია. მოდი <strong>Base64</strong> იდან დეკოდირება გავუკეთოთ ჩვენი მეილის კონტენტს:</p>

<blockquote>
  <table>
    <tbody>
      <tr>
        <td>**strings case_email</td>
        <td>base64 -D**</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<blockquote>
  <p>სადაც <strong>case_email</strong> მხოლოდ <strong>base64</strong> ს შეიცავს.</p>
</blockquote>

<blockquote>
  <p><strong>windows</strong> -ის შემთხვევაში — <a href="https://www.base64decode.org/"><strong>base64decode.org</strong></a></p>
</blockquote>

<p><img src="img/1__c7N3gf7__7d1IPSAI07fWKA.png" alt="" /></p>

<p>თავში არასაჭირო ინფორმაცია, მოდი მოვაშოროთ და ვნახოთ ჩვენი მეილი.</p>

<p><img src="img/1__Y0aZTrdtSNpyOnEZrxsw__A.png" alt="" /></p>

<p>კიდევ ბევრი არასაჭირო ინფორმაცია, მოდი ისინიც მოვაშოროთ.</p>

<p><img src="img/1__0zZlv9RqSsAd3uL1eDjdBw.png" alt="" /></p>

<p>ვაშორებთ ყველა <strong>HTML Tag</strong>-ს <strong>href</strong> ის გარდა, თუ რატომ ცოტახანში ვნახავთ.</p>

<p>მივიღეთ ჩვენი გასუფთავებული იმეილიც:</p>

<p><img src="img/1__gPIFA7Xb2Lv9fxGZ34h05Q.png" alt="" /></p>

<p>მეილიდან უკვე ყველაფერი გასაგები ხდება:</p>

<p>შემტევმა გაგზავნა მეილი სადაც <strong>EMS.GOV.GE</strong> ის მაგივრად, მსხვერპლი გადაიყვანა არასწორ ბმულზე <a href="http://ems.ga"><strong>http://ems.ga</strong></a> რომელიც ფიშინგ საიტია. ასეთი ტიპის ფიშინგ შეტევას <strong>Spear phishing</strong> ეწოდება.</p>

<p>ასევე ვარკვევთ, რომ შემტევი ცდილობს პირადი ინფორმაციის მოპარვას.</p>

<p><img src="img/1__S7N5XoJzSPkXQpJK__BVVcg.png" alt="" /></p>

<p>სულ ეს იყო, ამოვხსენით 2 სავარჯიშო და მივიღეთ თითოეულ კითხვაზე პასუხი.</p>

<p>კიბერ ოლიმპიადა ძალიან კარგი საშუალებაა ახალი ინფორმაციის შესასწავლად, <a href="https://cyber-lab.tech/"><strong>cyber-lab</strong></a> ზე შეგიძლიათ აკეთოთ სავარჯიშოები, რომლებიც გაგაცნობენ რეალურ ინციდენტებს, მსგავსი ტიპის ფიშინგ შეტევები უამრავია, ზარალდება ბევრი ადამიანი იმის გამო, რომ არ უკვირდებიან ლინკს სადაც ისინი გადადიან. ¯\_(ツ)_/¯</p>

<p>By <a href="https://medium.com/@aleksikistauri">Aleksi Kistauri</a> on <a href="https://medium.com/p/a6404da4a4df">August 10, 2019</a>.</p>

<p><a href="https://medium.com/@aleksikistauri/log-analysis-a6404da4a4df">Canonical link</a></p>

<p>Exported from <a href="https://medium.com">Medium</a> on January 6, 2020.</p>
:ET