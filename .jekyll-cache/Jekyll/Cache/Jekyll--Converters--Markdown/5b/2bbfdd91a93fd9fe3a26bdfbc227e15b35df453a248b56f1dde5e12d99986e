I"A<h1 id="pentest-gunmarket">Pentest: Gunmarket</h1>

<p>გამარჯობა, დღეს განვიხილავ კიბერ ოლიმპიადის მორიგი კატეგორიის Pentest-ის ერთ-ერთ სავარჯიშოს, Gunmarket-ს და ვეცდები, თითოეული ნაბიჯი…</p>

<p>გამარჯობა, დღეს განვიხილავ კიბერ ოლიმპიადის მორიგი კატეგორიის <strong>Pentest</strong>-ის ერთ-ერთ სავარჯიშოს, <strong>Gunmarket</strong>-ს და ვეცდები, თითოეული ნაბიჯი დეტალურად ავხსნა.</p>

<p>უკვე განხილული კატეგორიები თუ გაინტერესებს, შეგიძლია გაეცნოთ:</p>

<blockquote>
  <p><strong><em>Pcap Analysis</em></strong><em> — </em><a href="https://bit.ly/2M9L7f0"><em>https://bit.ly/2M9L7f0</em></a></p>
</blockquote>

<blockquote>
  <p><strong><em>რა არის Buffer Overflow ?</em></strong><em>-</em> <a href="https://bit.ly/2GZbNLr"><em>https://bit.ly/2GZbNLr</em></a></p>
</blockquote>

<blockquote>
  <p><strong>Log analysis </strong>— <a href="https://bit.ly/2HntEMc">https://bit.ly/2HntEMc</a></p>
</blockquote>

<p>აღნიშნულ დავალებაში განვიხილავთ ისეთ თემებს, როგორებიცაა:</p>

<ul>
  <li>პორტების სკანირება</li>
  <li><strong>Salted</strong> პაროლების გატეხვა <strong>JohnTheRipper</strong> ის საშუალებით.</li>
  <li>ცუდი <a href="https://stackoverflow.com/questions/17769011/how-does-cookie-based-authentication-work"><strong>cookie based authentication</strong></a>- ის მაგალითს</li>
  <li>დირექტორიების ენუმერაციას</li>
  <li><strong>WPScan</strong> ის გამოყენება და მისი დახმარებით ავტორიზაციაზე გვერდის ავლა.</li>
  <li><strong>Webshell</strong></li>
</ul>

<p>კიბერ ოლიმპიადაზე გამოყენებული სავარჯიშოები შეგიძლიათ <a href="https://cyber-lab.tech/geo/challenges"><strong>cyber-lab</strong></a> — ზე იხილოთ.</p>

<p>მაშ ასე, ამოცანის პირობა შემდეგია:</p>

<p><img src="img/1__98M9EnXdlkwxUwRSLLgKKw.png" alt="" /></p>

<p>მოცემული გვაქვს ორი კითხვა, რომლებიც 2 გასაღების პოვნას გვავალებს.</p>

<p>მოდი დავიწყოთ პირველი გასაღების ძებნა.</p>

<blockquote>
  <p><strong>nmap -sC -sV -oA nmap/gunmarket 185.212.254.63</strong></p>
</blockquote>

<ul>
  <li>-<strong>sC —</strong> დეფაულტ სკრიპტებისთვის.</li>
  <li><strong>-sV —</strong> ვერსიების ენუმერაციისთვის.</li>
  <li><strong>-oA nmap/gunmarket —</strong> აუთფუთის ფაილში ჩასაწერად.</li>
</ul>

<p><img src="img/1__D8XEEFXm7GPsk5nGIRN9HQ.png" alt="" /></p>

<p>გავიგეთ რომ საიტზე ღიაა პორტი <strong>80</strong>, მოდი გავხსნათ ის ვნახოთ რა გვაქვს მოცემული:</p>

<p><img src="img/1__cFO__kHnbs4B5LHQ0HOpFxA.png" alt="" /></p>

<p>მოცემულია მხოლოდ მარკეტის სურათი, სორსშიც საინტერესო არაფერია:</p>

<p><img src="img/1____WoLo8SKda6rP1cWOu6uGg.png" alt="" /></p>

<h3 id="გადავიდეთ-დირექტორიების-ენუმირაციაზე">გადავიდეთ დირექტორიების ენუმირაციაზე</h3>

<p>ენუმირაციისთვის გამოვიყენოთ dirb-ი</p>

<blockquote>
  <p><strong>dirb</strong> <a href="http://185.212.254.63">http://185.212.254.63</a></p>
</blockquote>

<blockquote>
  <p><strong>P.S.</strong> Ip თქვენ შემთხვევაში სავარაუდოთ სხვა იქნება.</p>
</blockquote>

<p><strong>dirb</strong>-მა რამდენიმე საინტერესო რამ იპოვა, პირველი — ეს არის ფოლდერი <strong>/wp</strong>, ხოლო მეორე <strong>/.bash_history</strong> ფაილი, რომელმაც სავარაუდოთ საინტერესო ინფორმაცია უნდა მოგვცემს.</p>

<p><img src="img/1__keU__QrpsgywBP3cAsHGzVQ.png" alt="" /></p>

<p>/<strong>wp</strong> დირქტორიაზე წვდომა არ გვაქვს:</p>

<p><img src="img/1__exsoqwaUciNUT5__Z53Itjw.png" alt="" /></p>

<p>ხოლო <strong>/.bash_history</strong> — ის ნახვა თავისუფლად შეგვიძლია.</p>

<p><img src="img/1__Q__fQ__CG8LjgKDjtkTggqHw.png" alt="" /></p>

<p>მასში ჩახედვისას საინტერესო ინფორმაციას ვგებულობთ:</p>

<ul>
  <li>დირექტორია <strong>/ctf/admin</strong></li>
  <li>ადმინის იუზერნეიმი და პაროლი(ჰეშირებული).</li>
</ul>

<p><img src="img/1__ev366r__IXUb1nz5McPGsQQ.png" alt="" /></p>

<p><strong>/ctf/admin</strong> დირექტორიაზე გადასვლისას გვთხოვს იუზერნეიმსა და პაროლს.</p>

<p><img src="img/1__GDZsO__z9VWARVAzNT2roRA.png" alt="" /></p>

<p>იუზერნეიმი უკვე ვიცით, რომ <strong>admin</strong>-ია, პაროლის გასაგებად კი <strong>JohnTheRipper</strong>-ი გამოვიყენოთ.</p>

<p>პაროლის გასატეხად <strong>john</strong>-თან ერთად დაგვჭირდება ვორდლისტი, ამ შემთხვევაში გამოვიყენებ <strong>rockyou</strong>-ის, რომლის ჩაწერაც აღნიშნული ლინკიდან შეგიძლიათ — <a href="https://github.com/brannondorsey/naive-hashcat/releases/tag/data"><strong>rockyou</strong></a><strong>.</strong></p>

<h3 id="გავტეხოთ-პაროლი">გავტეხოთ პაროლი</h3>

<blockquote>
  <p>რაიმე ფაილში ჩაწერეთ პაროლის ჰეში, ჩემ შემთხვევაში <strong>gunmarket_pass</strong> — ში მოვათავსე ის.</p>
</blockquote>

<p><img src="img/1__gP__YxbiWgF0bddVyFIHRmw.png" alt="**echo ‘admin:$apr1$T9QLutEh$9Y192r5I3TI52/bsdksIy.’ &gt; gunmarket_pass**" />
<strong>echo ‘admin:$apr1$T9QLutEh$9Y192r5I3TI52/bsdksIy.’ &gt; gunmarket_pass</strong></p>

<blockquote>
  <p><strong>john — wordlist=rockyou.txt gunmarket_pass</strong></p>
</blockquote>

<blockquote>
  <p>სადაც <strong>rockyou.txt</strong> თქვენი პაროლების სიის მისამართია, ხოლო <strong>gunmarket_pass</strong>- იმ ფაილის მისამართი სადაც პაროლის ჰეშია მოთავსებული.</p>
</blockquote>

<p><img src="img/1__mX9qct54dYqsjj7T50JYvQ.png" alt="" /></p>

<p>გავიგეთ ადმინის პაროლიც — <strong>admin123.</strong></p>

<p>შეგვიძლია დავუბრუნდეთ <strong>/ctf/admin/</strong> დირექტორიას, სადაც <strong>Cookie Monster</strong>-ის ფოტო გვხდება.</p>

<p><img src="img/1__xtZO4G5iYEfJnLWd8z__MMw.png" alt="" /></p>

<p>ჰინთი უკვე გასაგებია, დროა ქუქებს ჩავხედოთ:</p>

<p>ქუქებში ერთი ველი გვაქვს მოცემული, სახელად <strong>username</strong> ხოლო მისი მნიშვნელობა, ჩვენ შემთხვევაში <strong>guest_user</strong>-ია.</p>

<p><img src="img/1__MMB37uiQ9BzamhHU8janqA.png" alt="" /></p>

<p>მოდი შევცვალოთ <strong>guest_user</strong> — <strong>admin</strong>-ით და ვნახოთ რამოხდება:</p>

<p><img src="img/1__UkHCi9dhA8kIELDjGjQtUw.png" alt="" /></p>

<p>მივიღეთ პირველი გასაღები და ჰინთი მეორე გასაღების საძიებლად.</p>

<p><strong>/wp/wordpress</strong>-ზე გვხდება ვორდპრესის საიტი, რომელზეც არაფერი არ არის განთავსებული, არ გვაძლევს არანაირ მინიშნებას.</p>

<p><img src="img/1____n1Zj1UarphnN6Mtkx9rwA.png" alt="" /></p>

<p>მოდი ვცადოთ <strong>WPScan</strong> და ვნახოთ მოგვცემს თუ არა რაიმე შედეგს.</p>

<blockquote>
  <p><strong>WPScan</strong> არის ხელსაწყო <strong>Wordpress</strong> ის საიტების მოწყვლადობების საძიებლად.</p>
</blockquote>

<p><strong>WPScan</strong>-მა ოთხი საინტერესო მოწყვლადობა იპოვა, პირველის საშუალებით, როგორც ის გვეუბნება შეგვიძლია ავტორიზაციაზე გვერდის ავლა.</p>

<p>მოდი ვცადოთ მისი გამოყენება.</p>

<p><img src="img/1__safXuxmrNmqE5iw6boqwbA.png" alt="" /></p>

<p>როგორც <a href="https://www.exploit-db.com/exploits/43117"><strong>exploit-db</strong></a> დან ვგებულობთ, თუ საიტზე დეფაულტ იუზერი <strong>admin</strong>-ი გვყავს, შეგვიძლია მისი ანგარიშის გამოყენება, და საიტზე ავტორიზაციის გარეშე შესვლა ლინკში — <code class="highlighter-rouge">**?up_auto_log=true**</code> — ის მიმატებით.</p>

<p><img src="img/1__OdGW0UoBe3h0VlCDW46vig.png" alt="" /></p>

<p>გადავიდეთ ლინკზე —<a href="http://185.212.254.63/wp/wordpress/?up_auto_log=true"><strong>http://185.212.254.63/wp/wordpress/?up_auto_log=true</strong></a></p>

<p>იმუშავა აღნიშნულმა ექსპლოიტმა, საიტის სამართავ პანელზე წვდომა მოვიპოვეთ.</p>

<p><img src="img/1__Ng9Ry__Mo8CIYlfr43erpRg.png" alt="" /></p>

<p>საიტზე წვდომა გვაქვს, შემდეგი ნაბიჯია სისტემაზე წვდომის მოპოვება.</p>

<p>ამისთვის გამოვიყენებ <strong>webshell</strong>-ს.</p>

<p>უამრავ ადგილას შეგვიძლია შელის განთავსება, მე აქტიური თემის <strong>404.php</strong> ავირჩიე.</p>

<p>რომლის ნახვისთვისაც უნდა შეხვიდეთ <strong>Appearance</strong> შემდეგ კი <strong>editor-</strong>ში.</p>

<p>საქმე კიდევ უფრო გამარტივებული დაგხვდა, <strong>webshell</strong> კოდი უკვე განთავსებულაი <strong>404.php</strong> ში.</p>

<p>რომლის არ არსებობის შემთხვევაშიც, უბრალოდ დავამატებდით <strong>webshell</strong> კოდს და შევინახავდით ფაილს.</p>

<blockquote>
  <p>echo passthru($_GET[‘cmd’]);</p>
</blockquote>

<p><img src="img/1__1eVTnG__PJvQloVAh__e7ebQ.png" alt="" /></p>

<p><strong>webshell</strong> იც გვაქვს, მის გამოსაყენებლად საკმარისია გადავიდეთ იმ მისამართზე, სადაც ისაა განთავსებული და არგუმენტად გადავცეთ <strong>cmd=</strong> და შემდეგ ის ბრძანება, რისი გაშვებაც გვინდა.</p>

<p>საცდელად გავუშვათ <strong>cmd=ls</strong></p>

<p><img src="img/1__4Ll2U1SDlBNNwsjTCocGeg.png" alt="" /></p>

<p>ჩვენი შელი მუშაობს, ისღა დაგვრჩენია მეორე გასაღები ვიპოვოთ.</p>

<p>რამდენიმე დირექტორიით უკან გასვლის შემდეგ, გვხდება ფაილი, რომელიც სავარაუდოთ ჩვენი მეორე გასაღებია.</p>

<p><img src="img/1__ky0__7QGX2woIqhAUGkZeow.png" alt="" /></p>

<p>მის სანახავად საკმარისია <strong>ls</strong> შევცვალოთ <strong>cat</strong> ით და მისამართში დავამატოთ ჩვენი ფაილის სახელი:</p>

<p><img src="img/1__UzNPGb8BNWFOYU0qcLjHpg.png" alt="[**http://185.212.254.50/wp/wordpress/wp-content/themes/twentyseventeen/404.php?cmd=cat%20../../../../../s3cr3t_fil3_for_transactions**](http://185.212.254.50/wp/wordpress/wp-content/themes/twentyseventeen/404.php?cmd=cat%20../../../../../s3cr3t_fil3_for_transactions)" />
<a href="http://185.212.254.50/wp/wordpress/wp-content/themes/twentyseventeen/404.php?cmd=cat%20../../../../../s3cr3t_fil3_for_transactions"><strong>http://185.212.254.50/wp/wordpress/wp-content/themes/twentyseventeen/404.php?cmd=cat%20../../../../../s3cr3t_fil3_for_transactions</strong></a></p>

<p>მეორე გასაღებიც ვიპოვეთ.</p>

<p>კიბერ ოლიმპიადა ძალიან კარგი საშუალებაა ახალი ინფორმაციის შესასწავლად, <a href="https://cyber-lab.tech/"><strong>cyber-lab</strong></a> ზე შეგიძლიათ აკეთოთ სავარჯიშოები, რომლებიც გაგაცნობენ რეალურ ინციდენტებს, უამრავი ვორდპრესის <strong>“</strong>დეველოპერი<strong>”</strong> უშვებს მსგავს შეცდომას, არ ანახლებენ დროულად პლაგინებს, აყენებენ გატეხილებს (რომლებშიც გარანტირებულია მსგავში შელ კოდები).</p>

<p><strong>Feedback is welcome ;)</strong></p>

<p>By <a href="https://medium.com/@aleksikistauri">Aleksi Kistauri</a> on <a href="https://medium.com/p/16ab7a934d4e">August 24, 2019</a>.</p>

<p><a href="https://medium.com/@aleksikistauri/pentest-gunmarket-16ab7a934d4e">Canonical link</a></p>

<p>Exported from <a href="https://medium.com">Medium</a> on January 6, 2020.</p>
:ET