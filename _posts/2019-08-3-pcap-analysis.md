# Pcap Analysis

საქართველოში ყოველწლიურად ტარტდება კიბერ ოლიმპიადა(cybercube), რომელიც რამდენიმე ტიპისი სავარჯიშოს მოიცავ. დღეს განვიხილავ ერთ-ერთი…

საქართველოში ყოველწლიურად ტარტდება კიბერ ოლიმპიადა(**cybercube**), რომელიც რამდენიმე ტიპის სავარჯიშოს მოიცავს.

დღეს განვიხილავ ერთ-ერთი კატეგორიის, ქსელური ნაკადის ანალიზის, რამდენიმე ამოცანას და ვეცდები, თითოეული ნაბიჯი დეტალურად ავხსნა.

კიბერ ოლიმპიადაზე გამოყენებული სავარჯიშოები შეგიძლიათ [**cyber-lab**](https://cyber-lab.tech/geo/challenges) — ზე იხილოთ.

ჩვენი პირველი ამოცანა იქნება **Heist2**, რომლის პირობაც შემდეგია:

![](img/1__sOUQr9L54zZck__Q0L0z7zA.png)

მოცემული გვაქვს **PCAPNG** ფაილი, რომელზე სამუშაოდაც, **Heist2** ის მაგალითზე, **wireshark**\-ს გამოვიყენებ, ის იდეალური ხელსაწყოა ქსელური ნაკადის ანალიზისთვის. [**wireshark**](https://www.wireshark.org/download.html) ის დაყენება ძალიან მარტივია, ყველა პლატფორმაზეა ხელმისაწვდომი.

**wireshark** — ის დაყენების შემდეგ გახსენით ამოცანა. ის შემდეგნაირად გამოიყურება:

![](img/1__pEqjkyiZ96Z6Mtg__nkggKQ.png)

სანამ უშუალოდ **PCAP** ზე გადავალთ, ვნახოთ ამოცანის პირველი კითხვა:

![](img/1__AvXd0bK__tuQhMsChnm3Szg.png)

**IP** მისამართის გაგება რამდენიმე გზით შეგვიძლია, ამ შემთხვევაში შეგვიძლია ვნახოთ სტატისტიკა, თუ რომელ **IP** მისამართს რა წილი უკავია. **Statistics => IPv4 => Statistics => All Addresses**

![](img/1__Lk5vs6UKubX28A7RZKeqVA.png)

**192.168.2.25** დიდ ადგილს იკავებს, მოდი გავყვეთ მას და გავიგოთ სად და რაში ფიგურირებს. ამოცანის მეორე კითხვიდან ვასკვნით, რომ დამნაშავეები ერთმანეთს მეილის საშუალებით უკავშირებიან. ჩვენ შეგვიძლია გავფილტროთ მონაცემები და ვნახოთ, ფიგურირებს თუ არა ეს ჩვენი **IP** ბოროტმოქმედების მეილებში.

ინფორმაცია შეგვიძლია შემდეგი ბრძანებით გავფილტროთ, რომელიც გვიჩვენებს მხოლოდ იმ ინფორმაციას სადაც ჩვენი აიპი ფიგურირებს და მას გაფილტრავს **smtp** პროტოკოლის მიხედვით (მეილები იყენებენ მას)

> **ip.host == 192.168.2.25 && smtp**

![](img/1__gE35PeCejHEnEXUX9fth0Q.png)

გამოვიჭირეთ, ეს IP ნამდვილად ჩვენი ბოროტმოქმედისაა, ამასთან ერთად მეორე კითხვის პასუხიც გავიგეთ, 3 მეილი რომელიც მიმოწერაში ფიგურირებს :

> dkvatadze@dea.gov.ge, lkhasaia@dea.gov.ge, ltakashvili@dea.gov.ge

![](img/1__WseKyn7AnfhYcgbNrnS4Hw.png)

მეილის შიგთავსის ნახვა მარტივად შეგვიძლია:

**Rigth click => Follow = > TCP stream**

![](img/1__JPU6Eg9aBc5fbTiJTH__aGw.png)

მეილშიც გვაქვს ტექსტი რომელიც ენკოდირებულია **base64** ით, მისი დეკოდირება მარტივად შეგვიძლია  [**base64decode.org**](https://www.base64decode.org/)  ით, ასევე ლინუქსის მარტივი ქომანდითაც ¯\\\_(ツ)\_/¯

![](img/1__Z7tk__Z734t__DgGBPXV2ZmQ.png)

მეილის დეკოდირების შემდეგ ცალსახა ხდება მეხუთე ამოცანის პასუხიც, კრიმინალები **skimmer** —ის შეძენას აპირებენ.

![](img/1__s__nZIOWXPuYAvPZpGSJQrg.png)

პირველ მეილში საინტერესო აღარაფერია, გადავიდეთ შემდეგზე (იგივე ნაბიჯები უნდა გაიაროთ რაც პირველზე გავაკეთეთ):

![](img/1__QIhdBnq1pzOdItwSUzBbwg.png)

მეორე მეილით ვიგებთ მესამე კითხვის პასუხს, ბოროტმოქმედები იყენებენ **openstego**\-ს რომელიც **steganography**\-ის ერთ-ერთი თულია.

> შიფრაციის მეთოდით სწორედ **steganography** — ია იქნება

ასევე ვიგებთ ენკოდირებისას გამოყენებულ პაროლს — **cali cartel**, ისღა დაგვრჩენია სურათი ვიპოვოთ.

სურათიც მეილშია გაყოლილი, რომელიც დანარჩენი ინფორმაციისავით **base64** ით არის ენკოდირებული.

![](img/1__OYvps3dV3XnlC6Uom8c7nA.png)

ჩვენი ენკოდირებული ტექსტის სურათად გარდასაქმელად შეგვიძლია ონლაინ თულები გამოვიყენოთ, მოვაკოპიროთ მთლიანი ტექსტი და ჩავაფეისთოთ მაგალითად აქ [**codebeautify.org**](https://codebeautify.org/base64-to-image-converter), ნუ, უამრავი ასეთი საიტია.

ან ლინუქსით, უფრო მარტივად:

> **cat secret.txt| base64 -D > secret.png**

> სადაც **secret.txt** ის ფაილია რომელიც ჩვენ **base64** ით ენკოდირებულ ტექსტს შეიცავს.

ჩვენი base64 იდან ვიღებთ სურათს, რომლის დეკოდირებისთვისაც მიმოწერაში ნახსენები პროგრამა **openstego** შეგვიძლია გამოვიყენოთ.

![](img/1__QCh7Hcskd33mvdkA5__EK6w.png)

როგორც ამოცანის მეოთხე კითხვა გვეუბნება, **openstego**\-ს [**0.7.0**](https://github.com/syvaidya/openstego/releases/tag/openstego-0.7.0)  ვერსია გვჭირდება.

**openstego**\-ს დაყენების შემდეგ გადავიდეთ **Extract Data** -ზე, პირველ ველში ვუთითებთ ჩვენ სურათს, ხოლო მეორეში მისამართს სადაც გვუსრს, რომ დაექსტრაქტებული მონაცემები გამოიტანოს.

პაროლიც ვიცით — **cali cartel**

![](img/1__HX8AUuhAPdM2negt1WFV6g.png)

დაექსპორტების შემდეგ ვიღებთ სურათს, სადაც დროა მოცემული. მეოთხე კითხვის პასუხიც ცალსახა ხდება:

> **25 dec 2017 23:00**

**P.S.** ვინდოუსზე თუ ხართ, გაფართოება შეუცვალეთ .**txt** ზე, რის შემდეგაც თავისუფლად გახსნით, ან პირდაპირ რომელიმე ტექსტური ედიტორით გახსენით.

![](img/1__8ckzUgg97__YExjB4tj6GUg.png)

დაგვრჩა ბოლო კითხვა და ბოლო მეილი, რომლის შიგთავსიც შემდეგია :

![](img/1__H55W2hpWjiVpBmmWCeBi0g.png)

კოორდინატებს რუკაზე თუ ვნახავთ, დავინახავთ **TBC** ბანკის ბანკომატს, საბოლოო კითხვის პასუხიც გავიგეთ:

> **TBC**

![](img/1__lxSd4rYf7hBGrQ1VHFX6RQ.png)

### **შემდეგი ამოცანა Covert Channel**

მისი პირობა შემდეგია :

![](img/1__qAIWzVlSTP__seiHB9nlD9w.png)

მოდი ამ ამოცანის ამოსახნელად გამოვიყენო ხელსაწყო **tcpdump** რომელის დაყენებაც ლინუქსზე ძალიან მარტივად შეგიძლიათ.

გავხსნათ ჩვენი **PCAP**\-ი და ვნახოთ რა არის შიგნით:

> **tcpdump -X -r covert-channel.pcap**

> **\-r** ფაილის წასკითხად, **\-X** მთლიანი შიგთავსის სანახავად

![](img/1__KJKL1y3EPkoTLd9e6bASiQ.png)

ერთი შეხედვით საინტერესო არაფერია, მაგრამ თუ დავაკვირდებით **Ip — 10.10.75.1** დან გაგზავნილი ინფორმაციაში, გვხდება ასოები, რომლებიც ყოველ შემდეგ პაკეტში იცვლება

მოდი გრეპის საშუალებით ვნახოთ ამ **IP** იდან გაგზავნილი პაკეტები:

> **tcpdump -X -r covert-channel.pcap | grep -A1 10.10.75.1.distinct | grep -v 10.10.75.1.distinc**t

> **\-A1** ჩვენი აიპის შემდგომი ხაზის სანახავად, **grep -v 10.10.75.1.distinct** — მხოლოდ შემდგომი ხაზის სანახავად, აიპის გარეშე

![](img/1__wlYh2MBH4gBdZp4cZ__vQHg.png)

შეტყობინებაც უკვე შესამჩნევი ხდება, ცალ-ცალკე ასოები, რომ არ ვიწეროთ, როგორც ვინდოუსზე მოგვიწევდა, მოვაშოროთ ზედმეტი ყველაფერი და ვნახოთ ჩვენი შეტყობინება:

> **tcpdump -X -r covert-channel.pcap | grep -A1 10.10.75.1.distinct | grep -o ‘\\E..(.\\{1\\}’ | sed ‘s/E..(//g’ | tr -d ‘\\n’ | tr ‘.’ ‘ ‘**

> **grep -o ‘\\E..(.\\{1\\}’ | sed ‘s/E..(//g’**

> მხოლოდ იმ სიმბოლოს სანახავად რაც ‘**E..(**’ — ს შემდეგ მოდის

> **tr -d ‘\\n’ | tr ‘.’ ‘ ‘**

> ‘**\\n**’ -ს მოსაშორებლად და წერტილის სფეისით შესაცვლელად.

![](img/1__LhU4iFTRyFCP3__SaOblm4Q.png)

მივიღეთ ჩვენი შეტყობინებაც — ‘**we will place a bomb at the second floor**’.

სულ ეს იყო, იმედია მოგეწონათ.

კიბერ ოლიმპიადა ძალიან კარგი საშუალებაა ახალი ინფორმაციის შესასწავლად, პირადად მე ბევრი რამ მასწავლა, [**cyber-lab**](https://cyber-lab.tech) ზე შეგიძლიათ აკეთოთ სავარჯიშოები, რომლებიც გაგაცნობენ რეალურ ინციდენტებს და მსგავსი სავარჯიშოების კეთების ‘აზარტში’ შეგიყვანენ.

