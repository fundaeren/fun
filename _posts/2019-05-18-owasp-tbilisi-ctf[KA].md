# OWASP Tbilisi — CTF

15 მაის, საქართველოში ჩატარდა პირველი, პროგრამული უზრუნველყოფის უსაფრთხოებაზე ორიენტირებული არაკომერციული ორგანიზაციის — OWASP ის შეხვედრა…

![](img/1__KG__Xru7iwJU1zZuIFaUFkg.jpeg)

15 მაის, საქართველოში ჩატარდა პირველი, პროგრამული უზრუნველყოფის უსაფრთხოებაზე ორიენტირებული არაკომერციული ორგანიზაციის — **OWASP** ის შეხვედრა, სადაც განხილული იყო ისეთი თემები, როგორიცაა : **Application Security Verification Standard (ASVS)**, **OWASP top 10** და ა.შ.

ხოლო დღის ბოლოს ჩატარდა **CTF**, რომელიც 3 სავარჯისოსა და 9 კითხვას მოიცავდა. სავარჯიშოები კი განხილული თემებიდან იყო შედგენილი.

დღეს განვიხილავ ამ სავარჯიშოებს და ვეცდები ყველაფერი გარკვევით ავხსნა. დასპოილერება თუ არ გინდათ, გირჩევთ არ წაიკითხოთ.

დავიწყოთ კიბერ ჰიგიენის საკითხით.

### **THE.GOV.GE**

აღსანიშნავია ის ფაქტი, რომ ეს სავარჯიშო **OWASP** ის შეხვედრამდეც იყო [**Cyber-lab.tech**](http://Cyber-lab.tech) — ზე მაგრამ არავის არ ქონდა ამოხსნილი.

ამოცანის პირობა შემდეგია:

![](img/1__N7zBhv__jboVAlCdBpVereg.png)

მოცემული გვაქვს **IAPP.ZIP** — ფაილი, რომელშიც მარტივი, **flask** -ზე დაწერილი საიტია მოცემული.

მისი სტრუქტურა შემდეგნაირია:

![](img/1__rVF6bazuqbdm2OlaTGiQ8Q.png)

ფაილებშიც არაფერია საინტერესო:

![](img/1__LF6KJEE04s0yAcC__En7GWg.png)

ამ მომენტზე დიდხანს ვიყავი გაჭედილი სანამ ჰინთი არ მივიღე, თუ მას [**Github**](http://github.com/) — ზე მოვძებნით, წავაწყდებით მის რეპოზიტორს.

![](img/1__7daekteKhav6dOi8VV1MmA.png)

რეპოზიტორში ერთი შეხევდით არაფერი საინტერესო არ ხდება, იგივეა თითქმის ყველაფერი. კონფიგურაციაზეც არაფერი ნახსენები

![](img/1__2u2YwHWltsQir1JM76Hxcg.png)

ერთადერთი განსხვავება რაც არის, დამატებულია **app.zip** ფაილი, რომელიც ჩვენთვის საინტერესო უნდა იყოს.

სწორედ აქ ვხვდებით **.git** ფოლდერს

![](img/1__SWASocQ61Ooi92P3wVe74Q.png)

ლოგებს თუ ჩავხედავთ, აღმოვაჩენთ ჩვენთვის საინტერესო კომიტებს — “**Remove database connection information.**” და “**Add database connection information.**”

![](img/1__W9b0EoIC94J8vWVfSnjLZg.png)

რომლის ნახვაც მარტივად შეგვიძლია:

> **git log -p -2 81bda1fefbfe08769d98fe41b7d0226e71481a84**

![](img/1__OZliOKeP0gn8aoW4XEJnHg.png)

**vuala !** ვიპოვით კონფიგურაციის ფაილი. პირველ კითხვის პასუხიც აშკარა ხდება - **Sensitive data exposure**.

შემდეგი სავარჯიშო:

### **Tr33**

ამოცანის პირობა შემდეგია:

![](img/1__wHL0T__yOihP1XN6dKX6__HA.png)

**nmap** — მა და **dirb**\- მა მნიშვნელოვანი არაფერი გვაჩვენა, გადავიდეთ საიტზე

![](img/1__cfXW7F3wY9cXCA33OuiRiQ.png)

თუ ჩავხედავთ **script.js**\-ს შევამჩნევთ, რომ საიტზე იგზავნება **XML** ფაილი, რომელიც შეგვიძლია ინექციისთვის გამოვიყენოთ.

![](img/1__2__PlLUsX3COC7aNxzOAn__Q.png)

სანამ უშუალოდ ინექციაზე გადავალთ განვიხილოთ თუ რა არის თავად **XML**.

**XML** ანუ — **eXtensible Markup Language**

ჩავშალოთ :

**eXtensible** გულისხმობს იმას, რომ შენ შეგიძლია შექმნა შენი თეგები, აღწერო თუ როგორ გამოჩნდეს ეს თეგი და ა.შ.

**Markup Language** მა შეიძლება გაგვახსენოს **HTML** მაგრამ, **XML**\-სგან განსხვავებით **html** არის უფრო ‘პრეზენტაციის’ ენა რაც იმას გულისხმობს, რომ ის არ გვაწვდის იმის შესახებ მონაცემებს, თუ როგორი სტრუქტურა აქვს დოკუმენტს.

სწორად არასწორი **XML** გვაძლევს ისეთი შეტევის განხორციელების უფლებას, როგორიცაა **XXE**.

აღნიშნულ დავალებაშიც სწორედ **XXE** სისუსტეა, დავტესტოტ **XXE**\-ს მარტივი მაგალითით, ვნახოთ თუ რომელი დისტრიბუტორი აყენია სერვერზე:

![](img/1__SgfbztPAji0NjWgM__FdDqw.png)

ვნახოთ **/etc/passwd** ფაილი:

![](img/1__80Rp1drqsYB5lDxrNz3khQ.png)

როგორც ვხედავთ **XXE** შეტევა მუშაობს, დაგვრჩა **index.php** ფაილის შიგთავსის ნახვა.

ერთი შეხედვით იოლია, მაგრამ ჩვენ არ შეგვიძლია მას მივწვდეთ რომელიმე იუზერით შემდეგნაირად:

> **file:///var/home/vigaca/www/index.php**

რადგან ამ იუზერის ფაილებს ვერ ვნახავთ.

ჩვენ გვჭირდება **PHP Wrapper** ის განთავსება **XXE**\-ში, **PHP Wrapper** ის საშუალებით შეგვიძლია index.php-ს შიგთავსი გადავიყვანოთ base64 ში და გამოვიტანოთ ეს შედეგი:

> **<!DOCTYPE replace \[<!ENTITY xxe SYSTEM “php://filter/convert.base64-encode/resource=index.php”> \]>**

![](img/1__5istAx5nf9uaZ1tpOEJflA.png)

**index.php** ფაილიც მოვიპოვეთ, დაგვრჩა აუთფუთის **base64** იდან დიკოდი. რაც მარტივად შეგვიძლია [**base64decode.org**](https://www.base64decode.org) ის გამოყენებით.

![](img/1__4D7QYlJ4XfNoiXFRDIn7rA.png)

**vuala !** გვაქვს ადმინისტრატორის პაროლიც და **flag**\-იც.

შემდეგი სავარჯიშო:

### PHEl

ამოცანის პირობა შემდეგია:

![](img/1__gWGJbTTAFvK9Rgqpy7s__0w.png)

მოცემული გვაქვს **PHEL.ZIP** არქივი, რომლის სტრუქტურაც შემდეგნაირია

![](img/1__Mgwz7KatXHo7KTR7YCO5Zw.png)

**index.php** ში საინტერესო არაფერი არ ხდება, ხოლო **.htaccess** იდან ვარკვევთ, რომ იუზერს შეეძლო აეტვირთა **PHP** ფაილი, როგორც ფოტო. ანუ საქმე გვაქვს **Security Misconfiguration** — სთან

> **AddHandler application/x-httpd-php .jpg**

![](img/1__rMWbJvGNcBS2156yzu4v8A.png)

ე.ი. შემტევს შეეძლო **php shell-**ი აეტვირთა როგორც ფოტო, შეგვიძლია მარტივად გავფილტროთ, თუ ფოტო შეიცავს სიტყვა **php**\-ს გამოვიტანოთ შედეგი:

> **strings \*.jpg | grep php \***

![](img/1__xWumsDoXt0LmgcjtrLtpDA.png)

რის შედეგადაც ნათელი ხდება, რომ ფაილი, **403.jpg** შეიცავს **PHP Shell**\-ს, შემდეგ კითხვის პასუხიც გავიგეთ. დაგვჩა პაროლის დეშიფრაცია, რაც მარტივად შეგვიძლია ონლაინ [**hashkiller.co.uk**](https://hashkiller.co.uk/Cracker/SHA1) ის გამოყენებით, ან თუ სურვილი გაქვთ [**JohnTheRipper**](https://github.com/magnumripper/JohnTheRipper) -ის გამოყენებაც შეგიძლიათ.

![](img/1__ifr__lounYCTQ2iyTmGpwmw.png)

პაროლიც გავიგეთ — Hack3r.

მადლობა პოსტის წაკითხვისთვის ;დ, გავითვალისწინებ ნებისმიერ რჩევას და შენიშვნას.

**Follow me, for future posts ❤ .**

